<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¿Ÿå·å³¶æ—…ç¨‹è¦åŠƒ</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- è¨­å®š Tailwind è‡ªè¨‚é¡è‰²å’Œä¸»é¡Œ (MUST BE BEFORE REACT SCRIPT) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // ä½¿ç”¨è€…æŒ‡å®šé¡è‰²
                        'custom-base': '#FCFAF2',
                        'custom-primary': '#82663A',
                        'custom-accent': '#B68E55',
                        // è¡ç”Ÿé¡è‰²
                        'custom-light-accent': '#E0DACD', // è¼ƒæ·ºçš„å¼·èª¿è‰²èƒŒæ™¯
                        'custom-dark-text': '#5C4E33', // ç”¨æ–¼æ¨™é¡Œçš„æ·±è‰²æ–‡å­—
                        // å¡ç‰‡é¡å‹èƒŒæ™¯ ( Subtle differentiation )
                        'card-sight-bg': '#F6F4EB',  // æ™¯é»
                        'card-food-bg': '#FFFBF5',   // ç¾é£Ÿ
                        'card-transport-bg': '#F9F9F9', // äº¤é€š
                    }
                }
            }
        }
    </script>

    <style>
        /* ç¢ºä¿å­—é«”å’ŒåŸºæœ¬é¡¯ç¤º */
        body { 
            font-family: 'Inter', sans-serif; 
            color: #82663A; /* é è¨­æ–‡å­—é¡è‰² */
        }
        /* éš±è—æ‹–æ›³æ™‚çš„ç€è¦½å™¨é è¨­åœ–ç‰‡ */
        .dragging { opacity: 0.5; }

        /* Custom Scrollbar for Day Planner */
        .scrollable-planner::-webkit-scrollbar {
            width: 8px;
        }
        .scrollable-planner::-webkit-scrollbar-thumb {
            background-color: #E0DACD; /* æ·ºå¼·èª¿è‰² */
            border-radius: 4px;
        }
        .scrollable-planner::-webkit-scrollbar-track {
            background: #FCFAF2;
        }
    </style>
</head>
<body class="bg-custom-base min-h-screen">
    <!-- React æ‡‰ç”¨ç¨‹å¼çš„æ ¹å…ƒç´  -->
    <div id="root" class="max-w-5xl mx-auto p-0 sm:p-6 lg:p-8">
        <!-- æ‡‰ç”¨ç¨‹å¼å°‡æœƒæ¸²æŸ“åœ¨é€™è£¡ -->
    </div>
    
    <!-- è¼‰å…¥æ‰€æœ‰è…³æœ¬å’Œé‚è¼¯ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- React æ‡‰ç”¨ç¨‹å¼é‚è¼¯ (JSX å¯«åœ¨ <script> æ¨™ç±¤å…§) -->
    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        // --- Firebase/API ç›¸é—œè®Šæ•¸ (ç¢ºä¿åœ¨ Canvas ç’°å¢ƒä¸­é‹è¡Œ) ---
        const apiKey = ""; 
        const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        // --- éœæ…‹é…ç½®èˆ‡è¼”åŠ©å‡½å¼ ---

        const STATUS_OPTIONS = [
            // é‡æ–°è¨­è¨ˆç‹€æ…‹é¡è‰²ï¼Œä»¥ç¬¦åˆæ–°çš„é…è‰²æ–¹æ¡ˆ
            { value: 'pending', label: 'æœªé–‹å§‹', color: 'bg-custom-light-accent text-custom-dark-text border-custom-accent' },
            { value: 'in_progress', label: 'é€²è¡Œä¸­', color: 'bg-custom-accent text-white border-custom-accent' },
            { value: 'completed', label: 'å·²å®Œæˆ', color: 'bg-gray-200 text-gray-500 border-gray-400' },
        ];
        
        const TYPE_OPTIONS = {
            // ä½¿ç”¨è‡ªè¨‚çš„èƒŒæ™¯è‰²å’Œå¼·èª¿é‚Šæ¡†
            sight: { label: 'æ™¯é»', icon: 'â›°ï¸', bgColor: 'bg-card-sight-bg', borderColor: 'border-custom-accent' },
            food: { label: 'é¤å»³/ç¾é£Ÿ', icon: 'ğŸ½ï¸', bgColor: 'bg-card-food-bg', borderColor: 'border-custom-accent' },
            transport: { label: 'äº¤é€š/ä½å®¿', icon: 'âœˆï¸', bgColor: 'bg-card-transport-bg', borderColor: 'border-custom-accent' },
        };

        const initialItinerary = [
            { id: 1, day: 1, type: 'transport', location: "æ¿Ÿå·åœ‹éš›æ©Ÿå ´ (Jeju International Airport)", notes: "ç§Ÿè»Šï¼Œå‰å¾€æ¿Ÿå·å¸‚å€é…’åº—", status: 'completed', searchData: null },
            { id: 2, day: 1, type: 'food', location: "æ±é–€å¸‚å ´", notes: "å“åšé»‘è±¬è‚‰ä¸²å’Œç•¶åœ°å°åƒ", status: 'in_progress', searchData: null },
            { id: 3, day: 2, type: 'sight', location: "åŸå±±æ—¥å‡ºå³°", notes: "æ¸…æ™¨çˆ¬å±±è§€æ—¥å‡º", status: 'pending', searchData: null },
            { id: 4, day: 2, type: 'sight', location: "æ¶‰åœ°å²¬ (Seopjikoji)", notes: "æµ·å²¸æ•£æ­¥èˆ‡ç‡ˆå¡”", status: 'pending', searchData: null },
        ];

        // --- æ‹–æ›³æ’åºé‚è¼¯ (DayPlanner å…§éƒ¨ä½¿ç”¨) ---

        const handleDragStart = (e, item) => {
            e.dataTransfer.setData("itemId", item.id);
            // è®“æ‹–æ›³å…ƒç´ çœ‹èµ·ä¾†åŠé€æ˜
            setTimeout(() => e.target.classList.add('dragging'), 0);
        };

        const handleDragOver = (e) => {
            e.preventDefault(); // å…è¨±æ”¾ä¸‹
        };
        
        const handleDragEnd = (e) => {
            e.target.classList.remove('dragging');
        };

        // --- æ ¸å¿ƒçµ„ä»¶ï¼šå–®æ—¥è¡Œç¨‹åˆ—è¡¨ ---
        const DayPlanner = ({ day, dayItems, onUpdateOrder, onDelete, onStatusChange, onSearchGuide }) => {
            const handleDrop = (e, targetItem) => {
                e.preventDefault();
                e.target.classList.remove('dragging-over');

                const draggedItemId = parseInt(e.dataTransfer.getData("itemId"));
                const draggedItem = dayItems.find(item => item.id === draggedItemId);
                
                if (!draggedItem || draggedItem.id === targetItem.id) return;
                
                // é‡æ–°æ’åº
                const newItems = dayItems.filter(item => item.id !== draggedItemId);
                const targetIndex = newItems.findIndex(item => item.id === targetItem.id);
                
                // æ’å…¥è¢«æ‹–æ›³çš„é …ç›®
                newItems.splice(targetIndex, 0, draggedItem);
                
                onUpdateOrder(day, newItems);
            };

            const NaverMapButton = ({ location }) => (
                <a
                    href={`https://map.naver.com/p/search/${location}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="bg-custom-accent hover:bg-custom-primary text-white text-xs font-bold py-1 px-2 rounded-lg transition duration-200 shadow-sm flex items-center transform hover:scale-[1.05]"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fillRule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clipRule="evenodd" />
                    </svg>
                    å°èˆª
                </a>
            );

            const GuideDataDisplay = ({ data }) => {
                if (!data || !data.text) return null;
                
                // é—œéµå­—äº®é¡¯ (ä½¿ç”¨æ·±ç´…è‰²ä¾†å¼·èª¿é‡è¦è³‡è¨Šï¼Œèˆ‡ä¸»é¡Œè‰²æ­é…)
                let text = data.text || "";
                const highlights = ["å¿…åƒç¾é£Ÿ", "å¿…é»èœå–®", "å¿…è²·ä¼´æ‰‹ç¦®", "é‡è¦é ç´„ä»£è™Ÿ", "ç‡Ÿæ¥­æ™‚é–“", "äº¤é€šæ–¹å¼"];

                highlights.forEach(keyword => {
                    const regex = new RegExp(`(${keyword})`, 'g');
                    // ä½¿ç”¨ <b class="text-red-700 bg-red-100 p-0.5 rounded"> ä¾†äº®é¡¯é—œéµå­—
                    text = text.replace(regex, `<b class="text-red-700 bg-red-100 p-0.5 rounded">${keyword}</b>`);
                });

                return (
                    <div className="mt-4 p-4 bg-gray-50 border-t border-gray-200 rounded-b-xl">
                        <p className="text-sm font-semibold text-custom-dark-text mb-2 border-b border-dashed pb-1">å°éŠåˆ†æï¼š{data.title}</p>
                        {/* ä½¿ç”¨ dangerouslySetInnerHTML æ¸²æŸ“å¸¶æœ‰äº®é¡¯çš„æ–‡å­— */}
                        <p className="text-xs text-gray-700 leading-relaxed" dangerouslySetInnerHTML={{ __html: text }} />
                        {data.uri && (
                            <a href={data.uri} target="_blank" rel="noopener noreferrer" className="text-xs text-custom-accent hover:underline mt-2 block">
                                ä¾†æºé€£çµ
                            </a>
                        )}
                    </div>
                );
            };

            return (
                <div className="bg-white border border-gray-200 rounded-2xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-xl">
                    {/* å¤©æ•¸æ¨™é¡Œ - ä½¿ç”¨æ·ºåº•è‰²å’Œæ·±æ–‡å­—ï¼Œæ›´åƒç¶²ç«™é¢¨æ ¼ */}
                    <div className="bg-custom-light-accent text-custom-dark-text p-4 border-b border-custom-accent/50 flex justify-between items-center">
                        <h3 className="text-2xl font-extrabold flex items-center tracking-wider">
                            <span role="img" aria-label="Sun" className="text-2xl mr-2 opacity-70">â˜€ï¸</span> DAY {day}
                        </h3>
                        <span className="text-sm opacity-80 font-medium">{dayItems.length} å€‹é …ç›®</span>
                    </div>
                    
                    {/* è¡Œç¨‹åˆ—è¡¨ */}
                    <ul className="divide-y divide-gray-200">
                        {dayItems.map((item, index) => {
                            const statusInfo = STATUS_OPTIONS.find(s => s.value === item.status) || STATUS_OPTIONS[0];
                            const typeInfo = TYPE_OPTIONS[item.type] || TYPE_OPTIONS.sight;
                            const isCompleted = item.status === 'completed';

                            return (
                                <li 
                                    key={item.id} 
                                    draggable="true" // å•Ÿç”¨æ‹–æ›³
                                    onDragStart={(e) => handleDragStart(e, item)}
                                    onDragOver={handleDragOver}
                                    onDrop={(e) => handleDrop(e, item)}
                                    onDragEnd={handleDragEnd}
                                    // ä½¿ç”¨ä¸åŒçš„èƒŒæ™¯è‰²ä¾†å€åˆ†å¡ç‰‡é¡å‹ï¼Œä¸¦é…åˆä¸»è‰²èª¿
                                    className={`cursor-grab p-5 transition duration-150 border-l-4 border-l-custom-accent ${typeInfo.bgColor} ${isCompleted ? 'opacity-60' : 'hover:bg-gray-100'}`}
                                >
                                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center w-full">
                                        
                                        <div className="flex-1 min-w-0 pr-4 space-y-1">
                                            <div className="flex items-center space-x-3 mb-1">
                                                {/* æ™¯é»åç¨± */}
                                                <span className={`text-sm font-semibold px-2 py-0.5 rounded-full ${typeInfo.bgColor === 'bg-card-sight-bg' ? 'text-custom-primary' : 'text-custom-dark-text'} border border-custom-accent/50`}>
                                                    {typeInfo.icon} {typeInfo.label}
                                                </span>
                                                <span className="text-xl font-bold text-custom-dark-text">
                                                    {item.location}
                                                </span>
                                            </div>
                                            {item.notes && (
                                                <p className={`text-sm italic pl-1 ${isCompleted ? 'text-gray-500 line-through' : 'text-gray-700'}`}>
                                                    {item.notes}
                                                </p>
                                            )}
                                        </div>

                                        <div className="flex flex-wrap space-x-2 mt-4 md:mt-0 items-center justify-end flex-shrink-0">
                                            
                                            {/* å°éŠæŒ‰éˆ• */}
                                            <button
                                                onClick={() => onSearchGuide(item.id, item.location)}
                                                className={`bg-custom-accent hover:bg-custom-dark-text text-white text-xs font-bold py-1.5 px-3 rounded-lg transition duration-200 shadow-sm flex items-center transform hover:scale-[1.05] ${item.searchData ? 'opacity-60' : ''}`}
                                                disabled={item.searchData}
                                            >
                                                {item.searchData && item.searchData.text && item.searchData.text.includes("è¼‰å…¥ä¸­") ? 'â³ è¼‰å…¥ä¸­...' : item.searchData ? 'âœ… æ”»ç•¥' : 'ğŸ” å°éŠæ”»ç•¥'}
                                            </button>

                                            {/* å°èˆªæŒ‰éˆ• */}
                                            <NaverMapButton location={item.location} />
                                            
                                            {/* ç‹€æ…‹åˆ‡æ›ä¸‹æ‹‰é¸å–® */}
                                            <select
                                                value={item.status}
                                                onChange={(e) => onStatusChange(item.id, e.target.value)}
                                                className={`text-sm py-1.5 px-3 border rounded-lg shadow-sm focus:ring-custom-accent focus:border-custom-accent ${statusInfo.color}`}
                                            >
                                                {STATUS_OPTIONS.map(option => (
                                                    <option key={option.value} value={option.value}>
                                                        {option.label}
                                                    </option>
                                                ))}
                                            </select>
                                            
                                            {/* åˆªé™¤æŒ‰éˆ• */}
                                            <button
                                                onClick={() => onDelete(item.id)}
                                                className="bg-red-500 hover:bg-red-600 text-white text-sm font-medium py-1.5 px-3 rounded-lg transition duration-150 shadow-md focus:outline-none focus:ring-4 focus:ring-red-300 transform active:scale-95"
                                            >
                                                ğŸ—‘ï¸
                                            </button>
                                        </div>
                                    </div>
                                    {/* é¡¯ç¤ºå°éŠæœå°‹çµæœ */}
                                    <GuideDataDisplay data={item.searchData} />
                                </li>
                            );
                        })}
                    </ul>
                </div>
            );
        };

        // --- æ ¸å¿ƒçµ„ä»¶ï¼šApp ---
        const App = () => {
            const [itinerary, setItinerary] = useState(initialItinerary);
            const [newLocation, setNewLocation] = useState('');
            const [newDay, setNewDay] = useState(Math.max(1, ...initialItinerary.map(i => i.day)));
            const [newNotes, setNewNotes] = useState('');
            const [newType, setNewType] = useState('sight');
            const [nextId, setNextId] = useState(initialItinerary.length + 1);
            const [currentTab, setCurrentTab] = useState('itinerary');
            const [liveTime, setLiveTime] = useState(new Date());

            // --- å³æ™‚æ™‚é–“èˆ‡æ¨¡æ“¬å¤©æ°£ ---
            useEffect(() => {
                const timer = setInterval(() => setLiveTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            const formattedTime = liveTime.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });
            
            // æ¨¡æ“¬å¤©æ°£å’Œå»ºè­° (éœ€æ›¿æ›ç‚ºçœŸå¯¦ API)
            const weather = { location: "æ¿Ÿå·å¸‚", temp: "18Â°C", conditions: "å¤šé›²", advice: "å»ºè­°æ”œå¸¶è¼•ä¾¿å¤–å¥—å’Œå¤ªé™½çœ¼é¡ã€‚" };

            // --- è¡Œç¨‹æ“ä½œé‚è¼¯ ---

            const handleAddItem = (e) => {
                e.preventDefault();
                if (!newLocation.trim()) return;

                const newItem = {
                    id: nextId,
                    day: parseInt(newDay),
                    type: newType,
                    location: newLocation.trim(),
                    notes: newNotes.trim(),
                    status: 'pending',
                    searchData: null
                };
                
                setItinerary([...itinerary, newItem].sort((a, b) => a.day - b.day));
                setNextId(nextId + 1);
                
                setNewLocation('');
                setNewNotes('');
                setNewDay(Math.max(1, ...itinerary.map(i => i.day)));
                setNewType('sight');
            };

            const handleDeleteItem = (id) => {
                setItinerary(itinerary.filter(item => item.id !== id));
            };

            const handleStatusChange = (id, newStatus) => {
                setItinerary(itinerary.map(item => 
                    item.id === id ? { ...item, status: newStatus } : item
                ));
            };

            const handleUpdateOrder = (day, newDayItems) => {
                const otherItems = itinerary.filter(item => item.day !== day);
                setItinerary([...otherItems, ...newDayItems].sort((a, b) => a.day - b.day));
            };
            
            // --- å°éŠæœå°‹åŠŸèƒ½ (ä¸²æ¥ Google Search Tool) ---

            const handleSearchGuide = async (itemId, location) => {
                // ç‚ºäº†è®“æ¨¡å‹æ›´å°ˆæ³¨æ–¼é—œéµå­—ï¼Œå¢åŠ ä¸­æ–‡å’Œè‹±æ–‡æŸ¥è©¢
                const userQuery = `æ¿Ÿå·å³¶ ${location} æ™¯é»æ”»ç•¥ å¿…åƒç¾é£Ÿ ä¼´æ‰‹ç¦®`;
                
                try {
                    setItinerary(itinerary.map(item => 
                        item.id === itemId ? { ...item, searchData: { text: "ğŸ” æ­£åœ¨æœå°‹æ”»ç•¥ä¸­...", title: "è¼‰å…¥ä¸­" } } : item
                    ));
                    
                    const payload = {
                        contents: [{ parts: [{ text: userQuery }] }],
                        tools: [{ "google_search": {} }],
                    };

                    const response = await fetch(GEMINI_API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    
                    const result = await response.json();
                    const candidate = result.candidates?.[0];
                    let fetchedText = "æœªèƒ½æ‰¾åˆ°æœ‰æ•ˆæ”»ç•¥ã€‚";
                    let fetchedTitle = "ç„¡æ•ˆçµæœ";
                    let fetchedUri = null;

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        fetchedText = candidate.content.parts[0].text;
                        
                        const groundingMetadata = candidate.groundingMetadata;
                        if (groundingMetadata && groundingMetadata.groundingAttributions && groundingMetadata.groundingAttributions.length > 0) {
                            fetchedTitle = groundingMetadata.groundingAttributions[0].web?.title || 'æœå°‹çµæœ';
                            fetchedUri = groundingMetadata.groundingAttributions[0].web?.uri || null;
                        }
                    }
                    
                    // æ›´æ–° state
                    setItinerary(itinerary.map(item => 
                        item.id === itemId ? { ...item, searchData: { text: fetchedText, title: fetchedTitle, uri: fetchedUri } } : item
                    ));

                } catch (error) {
                    console.error("Guide Search Error:", error);
                    setItinerary(itinerary.map(item => 
                        item.id === itemId ? { ...item, searchData: { text: "âŒ æœå°‹å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡æˆ– API è¨­å®šã€‚", title: "éŒ¯èª¤" } } : item
                    ));
                }
            };

            // --- ä»‹é¢æ¸²æŸ“é‚è¼¯ ---

            const groupedItinerary = itinerary.reduce((acc, item) => {
                (acc[item.day] = acc[item.day] || []).push(item);
                // ç¢ºä¿æ¯å€‹ day å…§çš„ items æ˜¯æ’åºå¥½çš„ (ç”¨æ–¼æ‹–æ›³å¾Œçš„æŒä¹…åŒ–é †åº)
                acc[item.day].sort((a, b) => itinerary.indexOf(a) - itinerary.indexOf(b));
                return acc;
            }, {});

            const days = Object.keys(groupedItinerary).map(Number).sort((a, b) => a - b);
            
            const TabButton = ({ name, label }) => (
                <button
                    className={`px-6 py-3 font-bold transition-colors text-lg ${
                        currentTab === name
                            ? 'bg-custom-base text-custom-primary border-b-2 border-custom-accent shadow-inner'
                            : 'text-gray-500 hover:text-custom-primary/80'
                    }`}
                    onClick={() => setCurrentTab(name)}
                >
                    {label}
                </button>
            );

            const ToolsTab = () => (
                <div className="space-y-8 p-6 bg-white rounded-2xl shadow-xl">
                    <h3 className="text-3xl font-extrabold text-custom-dark-text border-b border-custom-accent/30 pb-3 mb-4">âœˆï¸ æ—…è¡Œå·¥å…·ç®±</h3>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        {/* èˆªç­è³‡è¨Šå¡ç‰‡ */}
                        <div className="bg-card-transport-bg p-6 border border-gray-200 rounded-xl shadow-md">
                            <h4 className="text-xl font-bold text-custom-primary mb-3 flex items-center">
                                èˆªç­è³‡è¨Š <span role="img" aria-label="Plane" className="ml-2">ğŸ›«</span>
                            </h4>
                            <textarea
                                className="w-full h-24 p-3 border border-gray-300 rounded-lg text-sm focus:border-custom-accent bg-white"
                                placeholder="è«‹è¼¸å…¥èˆªç­è™Ÿç¢¼ã€èµ·é™æ™‚é–“ã€èˆªç©ºå…¬å¸..."
                            ></textarea>
                            <button className="mt-3 w-full bg-custom-accent hover:bg-custom-primary text-white font-medium py-2 rounded-lg transition-colors">å„²å­˜èˆªç­</button>
                        </div>
                        
                        {/* ä½å®¿è³‡è¨Šå¡ç‰‡ */}
                        <div className="bg-card-transport-bg p-6 border border-gray-200 rounded-xl shadow-md">
                            <h4 className="text-xl font-bold text-custom-primary mb-3 flex items-center">
                                ä½å®¿è³‡è¨Š <span role="img" aria-label="Hotel" className="ml-2">ğŸ¨</span>
                            </h4>
                            <textarea
                                className="w-full h-24 p-3 border border-gray-300 rounded-lg text-sm focus:border-custom-accent bg-white"
                                placeholder="è«‹è¼¸å…¥é…’åº—åç¨±ã€åœ°å€ã€é ç´„è™Ÿç¢¼..."
                            ></textarea>
                            <button className="mt-3 w-full bg-custom-accent hover:bg-custom-primary text-white font-medium py-2 rounded-lg transition-colors">å„²å­˜ä½å®¿</button>
                        </div>

                        {/* ç·Šæ€¥è¯çµ¡é›»è©±å¡ç‰‡ */}
                        <div className="bg-card-transport-bg p-6 border border-gray-200 rounded-xl shadow-md">
                            <h4 className="text-xl font-bold text-custom-primary mb-3 flex items-center">
                                ç·Šæ€¥è¯çµ¡ <span role="img" aria-label="Emergency" className="ml-2">ğŸš¨</span>
                            </h4>
                            <p className="text-sm font-semibold mb-2 text-red-600">æ¿Ÿå·å³¶ç·Šæ€¥é›»è©±ï¼š119 / æ—…éŠè«®è©¢ï¼š1330</p>
                            <textarea
                                className="w-full h-16 p-3 border border-gray-300 rounded-lg text-sm focus:border-custom-accent bg-white"
                                placeholder="è«‹è¼¸å…¥ä¿éšªå…¬å¸ã€ä¿¡ç”¨å¡å®¢æœé›»è©±..."
                            ></textarea>
                            <button className="mt-3 w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 rounded-lg transition-colors">å„²å­˜è¯çµ¡äºº</button>
                        </div>

                        {/* è¨˜å¸³/é ç®—è¡¨å¡ç‰‡ (ç°¡åŒ–ç‰ˆ) */}
                        <div className="bg-card-transport-bg p-6 border border-gray-200 rounded-xl shadow-md">
                            <h4 className="text-xl font-bold text-custom-primary mb-3 flex items-center">
                                è¨˜å¸³/é ç®— <span role="img" aria-label="Money" className="ml-2">ğŸ’°</span>
                            </h4>
                            <input type="number" placeholder="é ç®—ç¸½é¡ (KRW)" className="w-full p-2 border border-gray-300 rounded-lg mb-2 focus:border-custom-accent bg-white" />
                            <textarea
                                className="w-full h-16 p-3 border border-gray-300 rounded-lg text-sm focus:border-custom-accent bg-white"
                                placeholder="è¨˜éŒ„æ”¯å‡ºé …ç›®ï¼šäº¤é€š â‚©50,000 / é£Ÿç‰© â‚©25,000..."
                            ></textarea>
                            <button className="mt-3 w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 rounded-lg transition-colors">å„²å­˜é ç®—</button>
                        </div>
                    </div>
                </div>
            );


            return (
                <div className="bg-custom-base min-h-screen">
                    
                    {/* é ‚éƒ¨å°èˆª/æ™‚é–“/å¤©æ°£ - ç°¡æ½”è¨­è¨ˆ */}
                    <div className="sticky top-0 z-10 bg-white shadow-xl p-4 mb-8 rounded-b-2xl border-b-4 border-custom-accent/30">
                        <div className="flex justify-between items-center max-w-5xl mx-auto">
                            <h1 className="text-3xl font-black text-custom-dark-text tracking-widest flex items-center">
                                <span role="img" aria-label="Palm Tree" className="text-3xl mr-3 opacity-80">ğŸŒ´</span> æ¿Ÿå·æ—…ç¨‹
                            </h1>
                            <div className="text-right text-custom-primary">
                                <p className="text-2xl font-extrabold text-custom-accent">{formattedTime}</p>
                                <p className="text-sm font-medium">{weather.location}: {weather.temp} | {weather.conditions}</p>
                            </div>
                        </div>
                        <p className="text-center text-sm font-light text-custom-primary mt-3 italic border-t border-gray-200 pt-2">{weather.advice}</p>
                    </div>

                    <div className="max-w-5xl mx-auto p-4 sm:p-0">
                        
                        {/* Tab æŒ‰éˆ• - é«˜é›…è¨­è¨ˆ */}
                        <div className="flex border-b border-gray-300 mb-8">
                            <TabButton name="itinerary" label="ğŸ“… è¡Œç¨‹è¦åŠƒ" />
                            <TabButton name="tools" label="ğŸ› ï¸ æ—…è¡Œå·¥å…·ç®±" />
                        </div>

                        {currentTab === 'itinerary' && (
                            <div className="space-y-10">
                                
                                {/* 1. æ–°å¢è¡Œç¨‹è¡¨å–® */}
                                <div className="border-2 border-custom-accent p-6 rounded-2xl bg-white shadow-xl">
                                    <h2 className="text-2xl font-bold text-custom-dark-text mb-5 flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 mr-2 text-custom-accent" viewBox="0 0 20 20" fill="currentColor">
                                            <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clipRule="evenodd" />
                                        </svg>
                                        å¿«é€Ÿæ–°å¢é …ç›®
                                    </h2>
                                    <form onSubmit={handleAddItem} className="space-y-4">
                                        <div className="grid grid-cols-1 sm:grid-cols-10 gap-4">
                                            
                                            <label className="flex flex-col sm:col-span-1">
                                                <span className="text-sm font-medium text-custom-primary mb-1">å¤©æ•¸</span>
                                                <input
                                                    type="number"
                                                    min="1"
                                                    value={newDay}
                                                    onChange={(e) => setNewDay(e.target.value)}
                                                    required
                                                    className="p-3 border border-gray-300 rounded-lg focus:ring-custom-accent focus:border-custom-accent transition duration-150 bg-custom-base"
                                                />
                                            </label>

                                            <label className="flex flex-col sm:col-span-3">
                                                <span className="text-sm font-medium text-custom-primary mb-1">é¡å‹</span>
                                                <select
                                                    value={newType}
                                                    onChange={(e) => setNewType(e.target.value)}
                                                    className="p-3 border border-gray-300 rounded-lg focus:ring-custom-accent focus:border-custom-accent transition duration-150 bg-custom-base"
                                                    required
                                                >
                                                    <option value="sight">{TYPE_OPTIONS.sight.icon} {TYPE_OPTIONS.sight.label}</option>
                                                    <option value="food">{TYPE_OPTIONS.food.icon} {TYPE_OPTIONS.food.label}</option>
                                                    <option value="transport">{TYPE_OPTIONS.transport.icon} {TYPE_OPTIONS.transport.label}</option>
                                                </select>
                                            </label>

                                            <label className="flex flex-col sm:col-span-6">
                                                <span className="text-sm font-medium text-custom-primary mb-1">åœ°é»åç¨±</span>
                                                <input
                                                    type="text"
                                                    value={newLocation}
                                                    onChange={(e) => setNewLocation(e.target.value)}
                                                    placeholder="ä¾‹å¦‚ï¼šç‰›å³¶ã€æ¼¢æ‹å±±..."
                                                    required
                                                    className="p-3 border border-gray-300 rounded-lg focus:ring-custom-accent focus:border-custom-accent transition duration-150 bg-custom-base"
                                                />
                                            </label>
                                        </div>
                                        <label className="flex flex-col">
                                            <span className="text-sm font-medium text-custom-primary mb-1">å‚™è¨»/æ´»å‹•</span>
                                            <input
                                                type="text"
                                                value={newNotes}
                                                onChange={(e) => setNewNotes(e.target.value)}
                                                placeholder="ä¾‹å¦‚ï¼šç§Ÿæ©Ÿè»Šç’°å³¶ã€åˆé¤åƒé»‘è±¬è‚‰"
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-custom-accent focus:border-custom-accent transition duration-150 bg-custom-base"
                                            />
                                        </label>
                                        <button
                                            type="submit"
                                            className="w-full bg-custom-accent hover:bg-custom-primary text-white font-bold py-3 px-4 rounded-xl transition duration-200 shadow-lg hover:shadow-xl transform hover:scale-[1.01] active:scale-[0.99] focus:outline-none focus:ring-4 focus:ring-custom-accent/50"
                                        >
                                            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 inline-block mr-1" viewBox="0 0 20 20" fill="currentColor">
                                                <path fillRule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clipRule="evenodd" />
                                            </svg>
                                            åŠ å…¥è¡Œç¨‹
                                        </button>
                                    </form>
                                </div>
                                
                                {/* 2. è¡Œç¨‹é¡¯ç¤ºå€åŸŸ */}
                                <div className="space-y-8 scrollable-planner">
                                    <h2 className="text-3xl font-black text-custom-dark-text border-b border-custom-accent/30 pb-3 flex items-center">
                                        <span role="img" aria-label="Map Pin" className="text-xl mr-2 opacity-70">ğŸ“</span> æˆ‘çš„å®Œæ•´è¡Œç¨‹ ({days.length} å¤©)
                                    </h2>
                                    
                                    {days.length === 0 ? (
                                        <p className="text-custom-primary/70 italic p-6 bg-white rounded-xl text-center shadow-inner">ç›®å‰æ²’æœ‰ä»»ä½•è¡Œç¨‹ï¼Œè¶•å¿«è¦åŠƒæ‚¨çš„æ¿Ÿå·å³¶ä¹‹æ—…å§ï¼</p>
                                    ) : (
                                        days.map(day => (
                                            <DayPlanner 
                                                key={day} 
                                                day={day} 
                                                dayItems={groupedItinerary[day]} 
                                                onUpdateOrder={handleUpdateOrder}
                                                onDelete={handleDeleteItem}
                                                onStatusChange={handleStatusChange}
                                                onSearchGuide={handleSearchGuide}
                                            />
                                        ))
                                    )}
                                </div>
                            </div>
                        )}
                        
                        {currentTab === 'tools' && <ToolsTab />}
                    </div>
                    
                    {/* æ‡¸æµ®æ–°å¢æŒ‰éˆ• (å³ä¸‹è§’ +) */}
                    {currentTab === 'itinerary' && (
                        <button
                            className="fixed bottom-6 right-6 bg-custom-accent hover:bg-custom-primary text-white p-4 rounded-full shadow-2xl transition duration-300 transform hover:scale-110 active:scale-90 focus:outline-none focus:ring-4 focus:ring-custom-accent/70"
                            onClick={() => {
                                // æ»¾å‹•åˆ°æ–°å¢è¡¨å–®
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                            }}
                            title="æ–°å¢è¡Œç¨‹"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                                <path fillRule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clipRule="evenodd" />
                            </svg>
                        </button>
                    )}
                </div>
            );
        };
        
        // æ¸²æŸ“ App å…ƒä»¶åˆ°é é¢
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(React.createElement(App, null));
    </script>
</body>
</html>
