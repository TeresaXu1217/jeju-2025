<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¿Ÿå·å³¶æ—…ç¨‹è¦åŠƒ</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- è¨­å®š Tailwind è‡ªè¨‚é¡è‰²å’Œä¸»é¡Œ (MUST BE BEFORE REACT SCRIPT) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // ä½¿ç”¨è€…æŒ‡å®šé¡è‰²
                        'custom-base': '#FCFAF2',       // åº•è‰² (å¥¶æ²¹ç™½)
                        'custom-primary': '#82663A',    // æ–‡å­—è‰² (æ·±æ£•)
                        'custom-accent': '#B68E55',     // å¼·èª¿è‰² (å…§æ–‚é‡‘)
                        // è¡ç”Ÿé¡è‰²
                        'custom-light-accent': '#E0DACD', // è¼ƒæ·ºçš„å¼·èª¿è‰²èƒŒæ™¯/ç·šæ¢
                        'custom-dark-text': '#5C4E33',    // ç”¨æ–¼æ¨™é¡Œçš„æ·±è‰²æ–‡å­—
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* ç¢ºä¿å­—é«”å’ŒåŸºæœ¬é¡¯ç¤º */
        body { 
            font-family: 'Inter', 'Noto Sans TC', sans-serif; 
            color: #82663A; 
        }
        /* å¯¦ç¾ iok.site ç°¡ç´„é¢¨æ ¼çš„ç·šæ¢åˆ†éš” */
        .info-card {
            border-top: 1px solid #E0DACD; /* æ·ºå¼·èª¿è‰²ç·šæ¢ */
        }
        .info-card:first-child {
            border-top: none;
        }
        /* éš±è—åŸç”Ÿæ»¾å‹•æ¢ï¼Œä½¿ç”¨è‡ªè¨‚æ¨£å¼ */
        .scrollable-planner::-webkit-scrollbar {
            display: none;
        }
        .scrollable-planner {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        /* è®“æ‹–æ›³ç‰©ä»¶åŠé€æ˜ */
        .dragging { opacity: 0.5; }

        /* Custom input style for elegant look */
        input[type="text"], input[type="number"], select, textarea {
            transition: all 0.2s;
            border-radius: 8px !important;
        }
    </style>
</head>
<body class="bg-custom-base min-h-screen">
    <!-- React æ‡‰ç”¨ç¨‹å¼çš„æ ¹å…ƒç´  -->
    <div id="root" class="max-w-5xl mx-auto p-0 sm:p-6 lg:p-8">
        <!-- æ‡‰ç”¨ç¨‹å¼å°‡æœƒæ¸²æŸ“åœ¨é€™è£¡ -->
    </div>
    
    <!-- è¼‰å…¥æ‰€æœ‰è…³æœ¬å’Œé‚è¼¯ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- React æ‡‰ç”¨ç¨‹å¼é‚è¼¯ (JSX å¯«åœ¨ <script> æ¨™ç±¤å…§) -->
    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Firebase/API ç›¸é—œè®Šæ•¸ (ç¢ºä¿åœ¨ Canvas ç’°å¢ƒä¸­é‹è¡Œ) ---
        const apiKey = ""; 
        const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        // --- éœæ…‹é…ç½®èˆ‡è³‡æ–™ ---

        // ç”¨æˆ¶æä¾›çš„åœ–ç‰‡ä½”ä½ç¬¦ (è«‹ç”¨ Base64 æ•¸æ“šæ›¿æ›)
        const FLIGHT_IMAGE_TAIPEI_JEJU = "https://placehold.co/400x150/E0DACD/82663A?text=å°åŒ—â†’æ¿Ÿå·æ©Ÿç¥¨åœ–ç‰‡";
        const FLIGHT_IMAGE_JEJU_TAIPEI = "https://placehold.co/400x150/E0DACD/82663A?text=æ¿Ÿå·â†’å°åŒ—æ©Ÿç¥¨åœ–ç‰‡";


        const CATEGORY_MAP = {
            main: { label: 'ä¸»è¦æ™¯é»è·¯ç·š', icon: 'ğŸ“', color: 'text-custom-accent' },
            food: { label: 'é™„è¿‘ç¾é£Ÿ', icon: 'ğŸœ', color: 'text-orange-500' },
            coffee: { label: 'ç”œé»/å’–å•¡', icon: 'â˜•', color: 'text-indigo-500' },
            alternative: { label: 'å‚™é¸æ™¯é»', icon: 'ğŸ’¡', color: 'text-gray-500' },
            transport: { label: 'äº¤é€š', icon: 'ğŸš—', color: 'text-green-500' },
        };

        const MOCK_DAILY_ITINERARY = [
            // Day 1: 12/04 (Thursday)
            { id: 101, day: 1, date: '12/04 é€±å››', category: 'transport', time: '07:00', location: 'æ¿Ÿå·åœ‹éš›æ©Ÿå ´ (Jeju International Airport) -> Jeju AutoHouse', notes: "æŠµé”ã€å–è»Šï¼Œæ¥é§è»Šæœå‹™", naverMap: 'https://map.naver.com/p/search/Jeju%20AutoHouse', searchData: null, officialLink: null },
            { id: 102, day: 1, date: '12/04 é€±å››', category: 'main', time: '10:00', location: 'åŸå±±æ—¥å‡ºå³° (Seongsan Ilchulbong)', notes: "ä¸–ç•Œè‡ªç„¶éºç”¢ï¼Œç¶“å…¸æ™¯é»", naverMap: 'https://map.naver.com/p/entry/place/11516281', searchData: null, officialLink: null },
            { id: 103, day: 1, date: '12/04 é€±å››', category: 'food', time: '13:00', location: 'æµ·å¥³ä¹‹å®¶ (Haenyeo House) (åŸå±±åº—)', notes: "åˆé¤ï¼šæ–°é®®æµ·è†½æ¹¯ã€é®‘é­šç²¥", naverMap: 'https://map.naver.com/p/search/í•´ë…€ì˜ì§‘', searchData: null, officialLink: null },
            { id: 104, day: 1, date: '12/04 é€±å››', category: 'main', time: '15:30', location: 'æ¶‰åœ°å²¬ (Seopjikoji)', notes: "æµ·å²¸ç·šæ­¥é“ã€ç‡ˆå¡”ã€éŸ“åŠ‡å ´æ™¯", naverMap: 'https://map.naver.com/p/entry/place/13361405', searchData: null, officialLink: null },
            { id: 105, day: 1, date: '12/04 é€±å››', category: 'transport', time: '18:00', location: 'ç¬¬ä¸€é–“ä½å®¿ (Aewol Coastal-ro 21104)', notes: "å…¥ä½ï¼Œæº–å‚™æ™šé¤", naverMap: 'https://map.naver.com/p/search/Jeju%20Island%20Jeju-si%20Aewol%20Coastal-ro%2021104', searchData: null, officialLink: null },
            
            // Day 2: 12/05 (Friday)
            { id: 201, day: 2, date: '12/05 é€±äº”', category: 'main', time: '09:00', location: 'å±±èŒ¶èŠ±ä¹‹ä¸˜ (Camellia Hill)', notes: "è³èŠ±æ‹ç…§è–åœ°ï¼Œ12æœˆæ˜¯å†¬æŸèŠ±å­£", naverMap: 'https://map.naver.com/p/entry/place/13158066', searchData: null, officialLink: 'http://www.camelliahill.co.kr/' },
            { id: 202, day: 2, date: '12/05 é€±äº”', category: 'food', time: '13:00', location: 'è¥¿æ­¸æµ¦æ¯æ—¥å¶ä¾†å¸‚å ´', notes: "åˆé¤ï¼šç•¶åœ°å°åƒã€æ©˜å­æœæ±ã€é»‘è±¬è‚‰ä¸²", naverMap: 'https://map.naver.com/p/entry/place/11624534', searchData: null, officialLink: null },
            { id: 203, day: 2, date: '12/05 é€±äº”', category: 'main', time: '16:00', location: 'å¤©å¸æ·µç€‘å¸ƒ', notes: "è¥¿æ­¸æµ¦å€ä¸‰å¤§ç€‘å¸ƒä¹‹ä¸€", naverMap: 'https://map.naver.com/p/entry/place/11624898', searchData: null, officialLink: null },
            { id: 204, day: 2, date: '12/05 é€±äº”', category: 'transport', time: '18:00', location: 'Heyy Seogwipo Hotel', notes: "å…¥ä½ç¬¬äºŒé–“ä½å®¿", naverMap: 'https://map.naver.com/p/entry/place/1639869302', searchData: null, officialLink: null },

            // Day 3: 12/06 (Saturday) - ç°¡ç•¥
            { id: 301, day: 3, date: '12/06 é€±å…­', category: 'main', time: '10:00', location: 'ç¨ç«‹å²© (Oedolgae)', notes: "å­¤ç¨çš„å·¨çŸ³ï¼Œæµ·é‚Šæ¼«æ­¥", naverMap: 'https://map.naver.com/p/entry/place/13444408', searchData: null, officialLink: null },
            { id: 302, day: 3, date: '12/06 é€±å…­', category: 'food', time: '13:00', location: 'æ±é–€å¸‚å ´ (æ™šé¤)', notes: "æ™šä¸Šä¾†é€›ï¼Œå¤œå¸‚ç¾é£Ÿ", naverMap: 'https://map.naver.com/p/entry/place/11620958', searchData: null, officialLink: null },
            { id: 303, day: 3, date: '12/06 é€±å…­', category: 'transport', time: '16:00', location: 'æ¿Ÿå·æ©Ÿå ´-Urbanstay', notes: "å…¥ä½ç¬¬ä¸‰é–“ä½å®¿", naverMap: 'https://naver.me/5S9zc50f', searchData: null, officialLink: null },

            // Day 4: 12/07 (Sunday) - çˆ¬å±±æº–å‚™æ—¥
            { id: 401, day: 4, date: '12/07 é€±æ—¥', category: 'main', time: '14:00', location: 'æ¶¯æœˆé‚‘ (Aewol)', notes: "å’–å•¡è¡—ã€æµ·é‚Šæ™¯è‰²", naverMap: 'https://map.naver.com/p/search/ì• ì›”ì', searchData: null, officialLink: null },
            { id: 402, day: 4, date: '12/07 é€±æ—¥', category: 'transport', time: '19:00', location: 'Oshare è£å‚™ç§Ÿå€Ÿ', notes: "é ˜å–æ¼¢æ‹å±±ç™»å±±è£å‚™", naverMap: 'https://map.naver.com/p/search/oshare.kr', searchData: null, officialLink: 'https://oshare.kr' },

            // Day 5: 12/08 (Monday) - æ¼¢æ‹å±±èˆ‡è¿”ç¨‹
            { id: 501, day: 5, date: '12/08 é€±ä¸€', category: 'main', time: '07:00', location: 'æ¼¢æ‹å±± (å¾¡é‡Œç‰§ä¸Šï¼Œéˆå®¤ä¸‹)', notes: "æœ¬æ¬¡è¡Œç¨‹é‡é»ï¼šç™»å±±æ´»å‹•", naverMap: 'https://map.naver.com/p/search/í•œë¼ì‚°', searchData: null, officialLink: null },
            { id: 502, day: 5, date: '12/08 é€±ä¸€', category: 'transport', time: '20:00', location: 'Jeju AutoHouse', notes: "é‚„è»Š (æ³¨æ„æ™‚é–“ï¼š20:00å‰)", naverMap: 'https://map.naver.com/p/search/Jeju%20AutoHouse', searchData: null, officialLink: null },
            { id: 503, day: 5, date: '12/08 é€±ä¸€', category: 'transport', time: '22:15', location: 'æ¿Ÿå·åœ‹éš›æ©Ÿå ´ (è¿”ç¨‹)', notes: "é£›æ©Ÿèµ·é£›", naverMap: 'https://map.naver.com/p/search/ì œì£¼êµ­ì œê³µí•­', searchData: null, officialLink: null },
        ];


        // --- æ‹–æ›³æ’åºé‚è¼¯ (DayPlanner å…§éƒ¨ä½¿ç”¨) ---

        const handleDragStart = (e, item) => {
            e.dataTransfer.setData("itemId", item.id);
            setTimeout(() => e.target.classList.add('dragging'), 0);
        };

        const handleDragOver = (e) => {
            e.preventDefault(); 
        };
        
        const handleDragEnd = (e) => {
            e.target.classList.remove('dragging');
        };

        // --- æ ¸å¿ƒçµ„ä»¶ï¼šå–®ä¸€å¡ç‰‡é …ç›® ---
        const ScheduleItem = ({ item, index, isCurrent, onUpdateOrder, onDelete, onSearchGuide }) => {
            const typeInfo = CATEGORY_MAP[item.category] || CATEGORY_MAP.main;
            
            const NaverMapButton = ({ location, mapUrl }) => (
                <a
                    href={mapUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="flex items-center text-custom-accent hover:text-custom-dark-text text-xs font-semibold transition duration-200 border border-custom-accent/50 rounded-full px-3 py-1 bg-white hover:bg-custom-light-accent transform hover:scale-[1.03]"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fillRule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clipRule="evenodd" />
                    </svg>
                    Naverå°èˆª
                </a>
            );

            const GuideDataDisplay = ({ data }) => {
                if (!data || !data.text) return null;
                
                let text = data.text || "";
                
                // ç‚ºäº†è®“æ–‡å­—æ›´ç¬¦åˆ iok.site çš„ç°¡ç´„é¢¨æ ¼ï¼Œå¼·èª¿è‰²åªç”¨åœ¨é€£çµæˆ–é‡è¦æ¨™é¡Œä¸Š
                return (
                    <div className="mt-4 p-4 bg-gray-50/50 border-t border-custom-light-accent rounded-b-xl">
                        <p className="text-sm font-semibold text-custom-dark-text mb-2 border-b border-dashed pb-1">
                            {data.title ? `å°éŠåˆ†æ: ${data.title}` : 'å°éŠæ”»ç•¥'}
                        </p>
                        <p className="text-xs text-gray-700 leading-relaxed" dangerouslySetInnerHTML={{ __html: text }} />
                        {data.uri && (
                            <a href={data.uri} target="_blank" rel="noopener noreferrer" className="text-xs text-custom-accent hover:underline mt-2 block font-medium">
                                ä¾†æºé€£çµ
                            </a>
                        )}
                    </div>
                );
            };

            const handleDrop = (e) => {
                e.preventDefault();
                e.target.classList.remove('dragging-over');

                const draggedItemId = parseInt(e.dataTransfer.getData("itemId"));
                const draggedItem = item.dayItems.find(i => i.id === draggedItemId);
                
                if (!draggedItem || draggedItem.id === item.id) return;
                
                // åŸ·è¡Œçˆ¶çµ„ä»¶çš„æ’åºé‚è¼¯ (é€™è£¡éœ€è¦å‚³éçµ¦ DayPlannerï¼Œä½†ç‚ºäº†å–®å…ƒåŒ–ï¼Œæˆ‘å€‘ç›´æ¥åœ¨ DayPlanner è™•ç†)
                // é€™è£¡åƒ…è™•ç†æ‹–æ›³è¦–è¦ºæ•ˆæœ
            };
            
            const currentItemClasses = isCurrent ? "border-l-4 border-l-red-500 bg-red-50/50 shadow-md" : "border-l-4 border-l-custom-light-accent hover:bg-gray-50";


            return (
                <li 
                    key={item.id} 
                    draggable="true" // å•Ÿç”¨æ‹–æ›³
                    onDragStart={(e) => handleDragStart(e, item)}
                    onDragOver={handleDragOver}
                    onDrop={handleDrop}
                    onDragEnd={handleDragEnd}
                    className={`cursor-grab p-5 transition duration-150 ${currentItemClasses} border-b border-custom-light-accent`}
                >
                    <div className="flex flex-col sm:flex-row justify-between items-start w-full">
                        <div className="flex-1 min-w-0 pr-4 space-y-2">
                            <div className="flex items-center space-x-3">
                                {/* æ™‚é–“å’Œé¡åˆ¥æ¨™ç±¤ */}
                                <span className="text-sm font-bold text-custom-dark-text border-r border-custom-light-accent pr-3">{item.time}</span>
                                <span className={`text-xs font-semibold px-2 py-0.5 rounded-full ${typeInfo.color} bg-custom-light-accent/50`}>
                                    {typeInfo.icon} {typeInfo.label}
                                </span>
                            </div>
                            {/* åœ°é»åç¨± */}
                            <h3 className="text-xl font-extrabold text-custom-dark-text leading-tight">
                                {item.location}
                                {isCurrent && <span className="ml-2 text-sm text-red-500">(ç¾åœ¨)</span>}
                            </h3>
                            {item.notes && (
                                <p className="text-sm italic text-gray-700">
                                    {item.notes}
                                </p>
                            )}
                        </div>

                        <div className="flex flex-wrap space-x-2 mt-4 sm:mt-0 items-center justify-end flex-shrink-0">
                            
                            {/* å°èˆªæŒ‰éˆ• */}
                            {item.naverMap && <NaverMapButton location={item.location} mapUrl={item.naverMap} />}

                            {/* å°éŠæŒ‰éˆ• */}
                            <button
                                onClick={() => onSearchGuide(item.id, item.location)}
                                className={`flex items-center text-xs font-semibold transition duration-200 border rounded-full px-3 py-1 transform hover:scale-[1.03] ${item.searchData ? 'bg-green-100 text-green-700 border-green-400' : 'bg-custom-accent text-white hover:bg-custom-primary'}`}
                                disabled={item.searchData && item.searchData.text && item.searchData.text.includes("è¼‰å…¥ä¸­")}
                            >
                                {item.searchData && item.searchData.text && item.searchData.text.includes("è¼‰å…¥ä¸­") ? 'â³ è¼‰å…¥ä¸­' : item.searchData ? 'âœ… æ”»ç•¥' : 'ğŸ” å°éŠæ”»ç•¥'}
                            </button>
                            
                            {/* åˆªé™¤æŒ‰éˆ• */}
                            <button
                                onClick={() => onDelete(item.id)}
                                className="bg-red-500/10 hover:bg-red-500 text-red-500 hover:text-white text-sm font-medium p-1.5 rounded-full transition duration-150 transform active:scale-95"
                                title="åˆªé™¤é …ç›®"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                    <path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 10-2 0v6a1 1 0 102 0V8z" clipRule="evenodd" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    {/* é¡¯ç¤ºå°éŠæœå°‹çµæœ */}
                    <GuideDataDisplay data={item.searchData} />
                    {item.officialLink && (
                        <a href={item.officialLink} target="_blank" rel="noopener noreferrer" className="text-xs text-blue-500 hover:underline mt-2 block font-medium">
                            å®˜æ–¹ç¶²ç«™
                        </a>
                    )}
                </li>
            );
        };


        // --- æ ¸å¿ƒçµ„ä»¶ï¼šå–®æ—¥è¡Œç¨‹åˆ—è¡¨ (å¯æ‹–æ›³æ’åº) ---
        const DayPlanner = ({ day, dayItems, onUpdateOrder, onDelete, onSearchGuide }) => {
            const now = useMemo(() => new Date(), []);
            // ç”±æ–¼æ²’æœ‰å¯¦éš›è¡Œç¨‹æ™‚é–“å’Œæ—¥æœŸï¼Œé€™è£¡ä½¿ç”¨ç°¡å–®çš„é‚è¼¯ï¼šç¬¬ä¸€å€‹é‚„æ²’å®Œæˆçš„é …ç›®ç‚º 'ç¾åœ¨'
            const currentItem = dayItems.find(item => item.time > new Date().toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', hour12: false }));
            const isToday = day === new Date().getDate(); // ç°¡æ˜“åˆ¤æ–·ä»Šå¤©ï¼Œå¯¦éš›æ‡‰æ ¹æ“šè¡Œç¨‹æ—¥æœŸ

            // å¯¦ä½œæ‹–æ›³æ”¾ç½®é‚è¼¯
            const handleDrop = (e, targetItem) => {
                e.preventDefault();
                const draggedItemId = parseInt(e.dataTransfer.getData("itemId"));
                const draggedItem = dayItems.find(item => item.id === draggedItemId);
                
                if (!draggedItem || draggedItem.id === targetItem.id) return;
                
                const newItems = dayItems.filter(item => item.id !== draggedItemId);
                const targetIndex = newItems.findIndex(item => item.id === targetItem.id);
                
                newItems.splice(targetIndex, 0, draggedItem);
                
                onUpdateOrder(day, newItems);
            };


            return (
                <div className="bg-white border border-custom-light-accent rounded-xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-xl">
                    {/* å¤©æ•¸æ¨™é¡Œ - æ¸…æ™°ã€ç°¡ç´„çš„ iok.site é ‚éƒ¨è¨­è¨ˆ */}
                    <div className="bg-custom-light-accent/50 text-custom-dark-text p-4 border-b border-custom-accent/50 flex justify-between items-center">
                        <h3 className="text-2xl font-extrabold flex items-center tracking-wider">
                            <span className="text-3xl font-extrabold mr-3 text-custom-accent">Day {day}</span> 
                            {dayItems.length > 0 && <span className="text-lg font-medium opacity-80">{dayItems[0].date}</span>}
                        </h3>
                    </div>
                    
                    {/* è¡Œç¨‹åˆ—è¡¨ */}
                    <ul className="divide-y divide-custom-light-accent">
                        {dayItems.map((item, index) => (
                            <li 
                                key={item.id} 
                                onDragOver={(e) => e.preventDefault()}
                                onDrop={(e) => handleDrop(e, item)}
                            >
                                <ScheduleItem 
                                    item={item} 
                                    index={index}
                                    isCurrent={item.id === currentItem?.id}
                                    onDelete={onDelete} 
                                    onSearchGuide={onSearchGuide}
                                />
                            </li>
                        ))}
                    </ul>
                </div>
            );
        };
        
        // --- Tab 1: é‡è¦è³‡è¨Š (KeyInfoTab) ---
        const KeyInfoTab = ({ FLIGHT_IMAGE_TAIPEI_JEJU, FLIGHT_IMAGE_JEJU_TAIPEI }) => {
            
            const InfoCard = ({ title, children, icon }) => (
                <div className="info-card p-6 border-b-2 border-custom-light-accent/50">
                    <h4 className="text-xl font-black text-custom-dark-text mb-4 border-l-4 border-custom-accent pl-3 flex items-center">
                        <span className="mr-2 text-2xl">{icon}</span>{title}
                    </h4>
                    <div className="text-sm leading-relaxed space-y-3">{children}</div>
                </div>
            );

            const DetailBlock = ({ label, value, type = 'text' }) => (
                <div className="flex justify-between items-start pt-2 border-t border-gray-100/50">
                    <span className="font-medium text-custom-primary/70 w-1/3">{label}</span>
                    <span className={`text-custom-dark-text font-bold text-right w-2/3 ${type === 'date' ? 'text-lg' : 'text-base'}`}>{value}</span>
                </div>
            );
            
            return (
                <div className="bg-white rounded-2xl shadow-xl overflow-hidden mb-10">
                    <h2 className="text-3xl font-black text-custom-dark-text p-6 border-b border-custom-accent/50">âœˆï¸ é‡è¦è³‡è¨Šä¸€è¦½</h2>
                    
                    {/* 1. èˆªç­æ©Ÿç¥¨ */}
                    <InfoCard title="èˆªç­æ©Ÿç¥¨" icon="ğŸ«">
                        {/* åœ–ç‰‡ä½”ä½ç¬¦ */}
                        <div className="flex flex-col md:flex-row gap-4">
                            <img src={FLIGHT_IMAGE_TAIPEI_JEJU} alt="å°åŒ—åˆ°æ¿Ÿå·æ©Ÿç¥¨" className="w-full md:w-1/2 rounded-lg object-cover shadow-sm" />
                            <img src={FLIGHT_IMAGE_JEJU_TAIPEI} alt="æ¿Ÿå·åˆ°å°åŒ—æ©Ÿç¥¨" className="w-full md:w-1/2 rounded-lg object-cover shadow-sm" />
                        </div>
                        
                        <div className="mt-4 space-y-2">
                            <h5 className="font-bold text-lg text-custom-accent">å»ç¨‹</h5>
                            <DetailBlock label="è·¯ç·š" value="å°åŒ— â†’ æ¿Ÿå·å¸‚" />
                            <DetailBlock label="æ—¥æœŸ" value="12 æœˆ 4 æ—¥ é€±å››" type="date" />
                            <DetailBlock label="æ™‚é–“" value="02:50 - 06:05" />
                            <DetailBlock label="é£›è¡Œæ™‚é–“" value="2 å°æ™‚ 15 åˆ†" />
                        </div>
                        <div className="space-y-2 pt-4 border-t border-dashed border-gray-200">
                            <h5 className="font-bold text-lg text-custom-accent">å›ç¨‹</h5>
                            <DetailBlock label="è·¯ç·š" value="æ¿Ÿå·å¸‚ â†’ å°åŒ—" />
                            <DetailBlock label="æ—¥æœŸ" value="12 æœˆ 8 æ—¥ é€±ä¸€" type="date" />
                            <DetailBlock label="æ™‚é–“" value="22:15 - 23:50" />
                            <DetailBlock label="é£›è¡Œæ™‚é–“" value="2 å°æ™‚ 35 åˆ†" />
                        </div>
                    </InfoCard>

                    {/* 2. ä½å®¿ */}
                    <InfoCard title="ä½å®¿è³‡è¨Š" icon="ğŸ¨">
                        
                        {/* ä½å®¿ 1 */}
                        <div className="p-3 bg-custom-light-accent/30 rounded-lg">
                            <h5 className="font-black text-lg text-custom-dark-text mb-2 border-b border-custom-accent/30 pb-1">ç¬¬ä¸€é–“ä½å®¿</h5>
                            <DetailBlock label="å…¥ä½" value="2025 å¹´ 12 æœˆ 4 æ—¥ é€±å›› (16:00å¾Œ)" type="date" />
                            <DetailBlock label="é€€æˆ¿" value="2025 å¹´ 12 æœˆ 5 æ—¥ é€±äº” (11:00å‰)" type="date" />
                            <DetailBlock label="æ™šæ•¸" value="1 æ™š" />
                            <DetailBlock label="åœ°å€" value="Jeju Island Jeju-si Aewol Coastal-ro 21104" />
                        </div>

                        {/* ä½å®¿ 2 */}
                        <div className="p-3 bg-custom-light-accent/30 rounded-lg">
                            <h5 className="font-black text-lg text-custom-dark-text mb-2 border-b border-custom-accent/30 pb-1">ç¬¬äºŒé–“ä½å®¿ (Heyy Seogwipo Hotel)</h5>
                            <DetailBlock label="å…¥ä½" value="2025 å¹´ 12 æœˆ 5 æ—¥ é€±äº” (16:00å¾Œ)" type="date" />
                            <DetailBlock label="é€€æˆ¿" value="2025 å¹´ 12 æœˆ 6 æ—¥ é€±å…­ (11:00å‰)" type="date" />
                            <DetailBlock label="æ™šæ•¸" value="1 æ™š" />
                            <div className="flex justify-between items-start pt-2 border-t border-gray-100/50">
                                <span className="font-medium text-custom-primary/70 w-1/3">å°èˆªé€£çµ</span>
                                <a href="https://map.naver.com/p/entry/place/1639869302?c=17.61,0,0,0,dh&placePath=/home?from=map&fromPanelNum=1&additionalHeight=76&timestamp=202511262236&locale=ko&svcName=map_pcv5&businessCategory=hotel" target="_blank" rel="noopener noreferrer" className="text-custom-accent hover:underline font-bold text-right w-2/3">æŸ¥çœ‹Naveråœ°åœ–</a>
                            </div>
                        </div>

                        {/* ä½å®¿ 3 */}
                        <div className="p-3 bg-custom-light-accent/30 rounded-lg">
                            <h5 className="font-black text-lg text-custom-dark-text mb-2 border-b border-custom-accent/30 pb-1">ç¬¬ä¸‰é–“ä½å®¿ (æ¿Ÿå·æ©Ÿå ´-Urbanstay)</h5>
                            <DetailBlock label="å…¥ä½" value="2025 å¹´ 12 æœˆ 6 æ—¥ é€±å…­ (16:00å¾Œ)" type="date" />
                            <DetailBlock label="é€€æˆ¿" value="2025 å¹´ 12 æœˆ 8 æ—¥ é€±ä¸€ (11:00å‰)" type="date" />
                            <DetailBlock label="æ™šæ•¸" value="2 æ™š" />
                            <div className="flex justify-between items-start pt-2 border-t border-gray-100/50">
                                <span className="font-medium text-custom-primary/70 w-1/3">å°èˆªé€£çµ</span>
                                <a href="https://naver.me/5S9zc50f" target="_blank" rel="noopener noreferrer" className="text-custom-accent hover:underline font-bold text-right w-2/3">æŸ¥çœ‹Naveråœ°åœ–</a>
                            </div>
                        </div>
                    </InfoCard>

                    {/* 3. å–è»Šè³‡è¨Š */}
                    <InfoCard title="å–è»Š/é‚„è»Šè³‡è¨Š" icon="ğŸš—">
                        <DetailBlock label="è¨‚å–®ç·¨è™Ÿ" value="1359039416311386" />
                        <DetailBlock label="ç§Ÿå€ŸæœŸé–“" value="2025 å¹´ 12 æœˆ 4 æ—¥ 07:00 è‡³ 12 æœˆ 8 æ—¥ 20:00" />
                        <DetailBlock label="ç¸½å¤©æ•¸" value="5 å¤©" />
                        <DetailBlock label="åœ°é»" value="Jeju AutoHouseï¼ˆ92 Yonghae-ro, Cheju, Jeju-doï¼‰" />
                        <DetailBlock label="äº¤é€šæ–¹å¼" value="æœ‰æ¥é§è»Š" />
                    </InfoCard>

                    {/* 4. å¿…å¸¶ç‰©å“ (æ¸…å–®) */}
                    <InfoCard title="å¿…å¸¶ç‰©å“æ¸…å–®" icon="ğŸ’">
                        <div className="grid grid-cols-2 md:grid-cols-3 gap-y-3">
                            {['è­·ç…§', 'å°ç£é§•ç…§', 'åœ‹éš›é§•ç…§', 'å°å¹£', 'ä¿¡ç”¨å¡(å»ºè­°å…©å¼µ)', 'è½‰æ¥é ­', 'æ‰‹æ©Ÿ', 'æ›æ´—è¡£ç‰©', 'æ‹–é‹', 'å¸ƒé‹', 'ç›¥æ´—ç”¨å“(ç‰™åˆ·ç‰™è†)', 'å¸¸å‚™è—¥', 'é›¨å…·', '3Cç”¨å“', 'ç”Ÿç†ç”¨å“'].map((item, index) => (
                                <div key={index} className="flex items-center text-custom-dark-text font-medium">
                                    <span className="text-custom-accent mr-2">âœ“</span> {item}
                                </div>
                            ))}
                        </div>
                    </InfoCard>
                    
                    {/* 5. ç©¿æ­æŒ‡å— */}
                    <InfoCard title="å†¬å­£ç©¿æ­æŒ‡å—" icon="ğŸ§¥">
                        <p className="font-extrabold text-custom-dark-text">æº«åº¦é ä¼°: 5Â°C - 13Â°C (é«”æ„Ÿæ›´ä½ï¼Œé¢¨å¼·å‹)</p>
                        <p className="text-custom-accent font-bold">åŸå‰‡ï¼šæ´‹è”¥å¼ç©¿æ³•ï¼ˆé˜²é¢¨ã€ä¿æš–ã€æ˜“ç©¿è„«ï¼‰</p>
                        <ul className="list-disc list-inside space-y-2 ml-4">
                            <li className="font-semibold text-custom-dark-text">å¤–å±¤ (é˜²é¢¨é—œéµ)ï¼š
                                <span className="font-normal text-gray-700">é˜²é¢¨åšå¤–å¥—æˆ–é•·ç‰ˆç¾½çµ¨è¡£ã€‚</span>
                            </li>
                            <li className="font-semibold text-custom-dark-text">å…§å±¤ (æ’æ±—ä¿æš–)ï¼š
                                <span className="font-normal text-gray-700">ç™¼ç†±è¡£ã€ä¿æš–å…§è¡£å¿…å‚™ã€‚</span>
                            </li>
                            <li className="font-semibold text-custom-dark-text">ä¸­å±¤ï¼š
                                <span className="font-normal text-gray-700">æ¯›è¡£ã€åšè¡›è¡£ã€‚</span>
                            </li>
                            <li className="font-semibold text-custom-dark-text">ä¸‹èº«ï¼š
                                <span className="font-normal text-gray-700">å…§åˆ·æ¯›é•·è¤²æˆ–åšè¤²è¥ªã€‚</span>
                            </li>
                            <li className="font-semibold text-custom-dark-text">é…ä»¶ (ä¿æš–é ­é ¸)ï¼š
                                <span className="font-normal text-gray-700">æ¯›å¸½ (é˜²é¢¨å¹é ­ç—›)ã€åœå·¾ã€æ‰‹å¥—ã€‚</span>
                            </li>
                        </ul>
                    </InfoCard>
                </div>
            );
        };

        // --- Tab 3: çˆ¬å±±è³‡è¨Š (HikingInfoTab) ---
        const HikingInfoTab = () => {
            const DetailBlock = ({ label, value, icon }) => (
                <div className="flex items-center space-x-2 p-2 bg-custom-base/50 rounded-lg">
                    <span className="text-xl text-custom-accent">{icon}</span>
                    <p className="text-sm">
                        <span className="font-medium text-custom-primary/70 mr-1">{label}:</span>
                        <span className="font-bold text-custom-dark-text">{value}</span>
                    </p>
                </div>
            );

            const PointList = ({ title, items, colorClass }) => (
                <div className="mt-6">
                    <h5 className={`text-lg font-black ${colorClass} mb-2`}>{title}</h5>
                    <ul className="list-disc list-inside space-y-1.5 ml-4 text-sm text-gray-700">
                        {items.map((item, index) => (
                            <li key={index} className="leading-relaxed">
                                <span className="font-bold text-custom-dark-text">{item.split('ï¼š')[0]}ï¼š</span>
                                {item.split('ï¼š').slice(1).join('ï¼š')}
                            </li>
                        ))}
                    </ul>
                </div>
            );

            return (
                <div className="bg-white rounded-2xl shadow-xl overflow-hidden p-6 mb-10">
                    <h2 className="text-3xl font-black text-custom-dark-text border-b border-custom-accent/50 pb-3 mb-6">ğŸ”ï¸ æ¼¢æ‹å±±ç™»å±±æ”»ç•¥</h2>
                    
                    {/* è£å‚™ç§Ÿå€Ÿ */}
                    <div className="p-4 bg-custom-light-accent/30 rounded-xl mb-6 shadow-inner">
                        <h4 className="text-xl font-black text-custom-dark-text mb-3 flex items-center">
                            <span className="mr-2 text-2xl">ğŸ¿</span> è£å‚™ç§Ÿå€Ÿ (Oshare)
                        </h4>
                        <DetailBlock label="åº—å®¶ç¶²ç«™" icon="ğŸŒ" value={<a href="https://oshare.kr" target="_blank" rel="noopener noreferrer" className="text-custom-accent hover:underline font-bold">https://oshare.kr</a>} />
                        <DetailBlock label="é ˜å–æ™‚é–“" icon="â°" value="12/07 19:00" />
                        <DetailBlock label="æ­¸é‚„æ™‚é–“" icon="â†©ï¸" value="12/08 19:00" />
                    </div>

                    {/* è·¯ç·šèˆ‡åŸºæœ¬è³‡è¨Š */}
                    <div className="p-4 bg-custom-light-accent/30 rounded-xl mb-6 shadow-inner">
                        <h4 className="text-xl font-black text-custom-dark-text mb-3 border-b border-custom-accent/30 pb-1">â„¹ï¸ è·¯ç·šæ¦‚è¦èˆ‡é è¨ˆæ™‚ç¨‹</h4>
                        <DetailBlock label="è·¯ç·š" icon="â¡ï¸" value="å¾¡é‡Œç‰§ä¸Š (ì–´ë¦¬ëª©) éˆå®¤ä¸‹ (ì˜ì‹¤) - éç™»é ‚è·¯ç·š" />
                        <DetailBlock label="é›£åº¦" icon="â­" value="æ¯”è¼ƒç°¡å–®çš„è·¯ç·š" />
                        <DetailBlock label="ç¸½è·é›¢" icon="ğŸ“" value="ç´„ 12.6 KM" />
                        <DetailBlock label="é è¨ˆè€—æ™‚" icon="â±ï¸" value="5.5 ~ 6 å°æ™‚" />
                        <DetailBlock label="å±±ä¸Šæ°£æº«" icon="ğŸ¥¶" value="0Â°C è‡³ -10Â°C (é«”æ„Ÿæ›´ä½)" />
                    </div>
                    
                    {/* ç©¿æ­æ³¨æ„äº‹é … */}
                    <PointList
                        title="âš ï¸ çˆ¬å±±ç©¿æ­æ³¨æ„äº‹é … (æ´‹è”¥å¼ç©¿æ­)"
                        colorClass="text-custom-accent"
                        items={[
                            "é ­éƒ¨ï¼šæ¯›å¸½ï¼ˆå¿…å‚™ï¼‰ã€åœè„–ï¼ˆæ¯”åœå·¾å¥½ç”¨ï¼Œä¸æœƒè¢«é¢¨å¹æ•£ï¼‰ã€‚",
                            "å…§å±¤ï¼šæ’æ±—è¡£/ç™¼ç†±è¡£ï¼ˆçµ•å°ä¸è¦ç©¿æ£‰è³ªï¼Œæµæ±—æ¿•äº†æœƒå¤±æº«ï¼‰ã€‚",
                            "ä¸­å±¤ï¼šåˆ·æ¯›è¡£ (Fleece) æˆ–è¼•è–„ç¾½çµ¨èƒŒå¿ƒã€‚",
                            "å¤–å±¤ï¼šé˜²é¢¨é˜²æ°´å¤–å¥— (ç¡¬æ®¼)ï¼Œæ­¤å±¤æœ€é‡è¦ã€‚",
                            "ä¸‹èº«ï¼šå…§åˆ·æ¯›çš„é˜²é¢¨ç™»å±±è¤²ã€‚",
                            "å‚™ç”¨ï¼šåšç¾Šæ¯›è¥ªï¼ˆå»ºè­°å¤šå¸¶ä¸€é›™å‚™ç”¨ï¼Œè¬ä¸€æ¿•äº†å¯æ›ï¼‰ã€‚",
                            "é‹å­ï¼šé«˜ç­’é˜²æ°´ç™»å±±é‹æœ€ä½³ï¼ˆä¿è­·è…³è¸ï¼‰ï¼Œæ­é…ç§Ÿå€Ÿå†°çˆªã€‚",
                        ]}
                    />

                    {/* è£œçµ¦å“ */}
                    <PointList
                        title="ğŸ è£œçµ¦å“å»ºè­° (ç•¶åœ°è³¼è²·)"
                        colorClass="text-red-500"
                        items={[
                            "é£²ç”¨æ°´ï¼šè‡³å°‘ 1.5 - 2 å…¬å‡ã€‚",
                            "é£Ÿç‰©ï¼šèƒ½é‡æ£’ (é«˜ç†±é‡é£Ÿç‰©)ã€é›»è§£è³ªé‹å‹•é£²æ–™ã€é£¯æ²ã€éºµåŒ…ç­‰ã€‚",
                            "æ³¨æ„ï¼šè·¯ä¸Šé¿é›£æ‰€æ²’æœ‰æä¾›é¤é£Ÿï¼Œå¿…é ˆè‡ªå‚™ï¼",
                        ]}
                    />

                </div>
            );
        };


        // --- æ ¸å¿ƒçµ„ä»¶ï¼šApp ---
        const App = () => {
            const [itinerary, setItinerary] = useState(MOCK_DAILY_ITINERARY);
            const [newLocation, setNewLocation] = useState('');
            const [newDay, setNewDay] = useState(Math.max(1, ...MOCK_DAILY_ITINERARY.map(i => i.day)));
            const [newNotes, setNewNotes] = useState('');
            const [newCategory, setNewCategory] = useState('main');
            const [nextId, setNextId] = useState(MOCK_DAILY_ITINERARY.length + 1);
            const [currentTab, setCurrentTab] = useState('info'); // é è¨­ Tab 1
            const [liveTime, setLiveTime] = useState(new Date());

            // --- å³æ™‚æ™‚é–“èˆ‡å¤©æ°£ (æ¨¡æ“¬) ---
            useEffect(() => {
                const timer = setInterval(() => setLiveTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);
            const formattedTime = liveTime.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });
            const weather = { location: "æ¿Ÿå·å¸‚", temp: "18Â°C", conditions: "å¤šé›²/é¢¨å¼·", advice: "ä»Šæ—¥æµ·é‚Šé¢¨å¤§ï¼Œå»ºè­°ç©¿è‘—é˜²é¢¨å¤–å¥—ã€‚" };


            // --- è¡Œç¨‹æ“ä½œé‚è¼¯ ---

            const handleAddItem = (e) => {
                e.preventDefault();
                if (!newLocation.trim()) return;

                const newItem = {
                    id: nextId,
                    day: parseInt(newDay),
                    date: `12/${String(newDay).padStart(2, '0')}`, // ç°¡æ˜“æ—¥æœŸè™•ç†
                    category: newCategory,
                    time: new Date().toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit', hour12: false }), // ä½¿ç”¨ç•¶å‰æ™‚é–“ä½œç‚ºé è¨­
                    location: newLocation.trim(),
                    notes: newNotes.trim(),
                    naverMap: `https://map.naver.com/p/search/${encodeURIComponent(newLocation.trim())}`,
                    searchData: null,
                    officialLink: null,
                };
                
                setItinerary([...itinerary, newItem].sort((a, b) => a.day - b.day || a.time.localeCompare(b.time)));
                setNextId(nextId + 1);
                
                setNewLocation('');
                setNewNotes('');
                setNewDay(Math.max(1, ...itinerary.map(i => i.day)));
                setNewCategory('main');
            };

            const handleDeleteItem = (id) => {
                setItinerary(itinerary.filter(item => item.id !== id));
            };

            const handleUpdateOrder = (day, newDayItems) => {
                const otherItems = itinerary.filter(item => item.day !== day);
                // é‡æ–°è¨­ç½® item é †åºæ™‚ï¼Œä¿æŒå…¶ä»–é …ç›®ä¸è®Š
                setItinerary([...otherItems, ...newDayItems].sort((a, b) => a.day - b.day || a.time.localeCompare(b.time)));
            };
            
            // --- å°éŠæœå°‹åŠŸèƒ½ (ä¸²æ¥ Google Search Tool) ---

            const handleSearchGuide = async (itemId, location) => {
                const userQuery = `æ¿Ÿå·å³¶ ${location} æ™¯é»æ”»ç•¥ æ¨è–¦èœå–®æˆ–éŠç©è³‡è¨Š å®˜æ–¹ç¶²ç«™`;
                
                try {
                    // 1. è¨­ç½®è¼‰å…¥ç‹€æ…‹
                    setItinerary(itinerary.map(item => 
                        item.id === itemId ? { ...item, searchData: { text: "ğŸ” æ­£åœ¨æœå°‹æ”»ç•¥ä¸­...", title: "è¼‰å…¥ä¸­" } } : item
                    ));
                    
                    const payload = {
                        contents: [{ parts: [{ text: userQuery }] }],
                        tools: [{ "google_search": {} }],
                    };

                    const response = await fetch(GEMINI_API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    
                    const result = await response.json();
                    const candidate = result.candidates?.[0];
                    let fetchedText = "æœªèƒ½æ‰¾åˆ°æœ‰æ•ˆæ”»ç•¥ã€‚";
                    let fetchedTitle = "ç„¡æ•ˆçµæœ";
                    let fetchedUri = null;

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        fetchedText = candidate.content.parts[0].text;
                        
                        const groundingMetadata = candidate.groundingMetadata;
                        if (groundingMetadata && groundingMetadata.groundingAttributions && groundingMetadata.groundingAttributions.length > 0) {
                            fetchedTitle = groundingMetadata.groundingAttributions[0].web?.title || 'æœå°‹çµæœ';
                            fetchedUri = groundingMetadata.groundingAttributions[0].web?.uri || null;
                        }
                    }
                    
                    // 2. æ›´æ–° state
                    setItinerary(itinerary.map(item => 
                        item.id === itemId ? { ...item, searchData: { text: fetchedText, title: fetchedTitle, uri: fetchedUri } } : item
                    ));

                } catch (error) {
                    console.error("Guide Search Error:", error);
                    setItinerary(itinerary.map(item => 
                        item.id === itemId ? { ...item, searchData: { text: "âŒ æœå°‹å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡æˆ– API è¨­å®šã€‚", title: "éŒ¯èª¤" } } : item
                    ));
                }
            };

            // --- ä»‹é¢æ¸²æŸ“é‚è¼¯ ---

            const groupedItinerary = useMemo(() => itinerary.reduce((acc, item) => {
                (acc[item.day] = acc[item.day] || []).push(item);
                // ç¢ºä¿æ¯å€‹ day å…§çš„ items æ˜¯æ’åºå¥½çš„
                acc[item.day].sort((a, b) => a.time.localeCompare(b.time));
                return acc;
            }, {}), [itinerary]);

            const days = Object.keys(groupedItinerary).map(Number).sort((a, b) => a - b);
            
            const TabButton = ({ name, label }) => (
                <button
                    className={`px-6 py-3 font-bold transition-colors text-lg focus:outline-none ${
                        currentTab === name
                            ? 'bg-custom-base text-custom-primary border-b-2 border-custom-accent shadow-inner'
                            : 'text-gray-500 hover:text-custom-primary/80'
                    }`}
                    onClick={() => setCurrentTab(name)}
                >
                    {label}
                </button>
            );


            return (
                <div className="bg-custom-base min-h-screen">
                    
                    {/* é ‚éƒ¨å°èˆª/æ™‚é–“/å¤©æ°£ - ç°¡æ½”è¨­è¨ˆ */}
                    <div className="sticky top-0 z-10 bg-white shadow-xl p-4 mb-8 rounded-b-2xl border-b-4 border-custom-accent/30">
                        <div className="flex justify-between items-center max-w-5xl mx-auto">
                            <h1 className="text-3xl font-black text-custom-dark-text tracking-widest flex items-center">
                                <span role="img" aria-label="Palm Tree" className="text-3xl mr-3 opacity-80">ğŸŒ´</span> JEJU TRIP
                            </h1>
                            <div className="text-right text-custom-primary">
                                <p className="text-2xl font-extrabold text-custom-accent">{formattedTime}</p>
                                <p className="text-sm font-medium">{weather.location}: {weather.temp} | {weather.conditions}</p>
                            </div>
                        </div>
                        <p className="text-center text-sm font-light text-custom-primary mt-3 italic border-t border-gray-200 pt-2">{weather.advice}</p>
                    </div>

                    <div className="max-w-5xl mx-auto p-4 sm:p-0">
                        
                        {/* Tab æŒ‰éˆ• - é«˜é›…è¨­è¨ˆ */}
                        <div className="flex border-b border-gray-300 mb-8">
                            <TabButton name="info" label="é‡è¦è³‡è¨Š / ç©¿æ­" />
                            <TabButton name="daily" label="æ¯æ—¥è¡Œç¨‹ / æ™¯é»" />
                            <TabButton name="hiking" label="ğŸ”ï¸ çˆ¬å±±è³‡è¨Š" />
                        </div>

                        {currentTab === 'info' && <KeyInfoTab FLIGHT_IMAGE_TAIPEI_JEJU={FLIGHT_IMAGE_TAIPEI_JEJU} FLIGHT_IMAGE_JEJU_TAIPEI={FLIGHT_IMAGE_JEJU_TAIPEI} />}
                        
                        {currentTab === 'hiking' && <HikingInfoTab />}

                        {currentTab === 'daily' && (
                            <div className="space-y-10">
                                
                                {/* 1. æ–°å¢è¡Œç¨‹è¡¨å–® (éš±è—/å±•é–‹å¼) */}
                                <div className="border-2 border-custom-accent p-6 rounded-2xl bg-white shadow-xl">
                                    <details>
                                        <summary className="text-2xl font-bold text-custom-dark-text cursor-pointer pb-2 flex items-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 mr-2 text-custom-accent" viewBox="0 0 20 20" fill="currentColor">
                                                <path fillRule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clipRule="evenodd" />
                                            </svg>
                                            å¿«é€Ÿæ–°å¢é …ç›®
                                        </summary>
                                        <form onSubmit={handleAddItem} className="space-y-4 pt-4 border-t border-dashed border-gray-200 mt-2">
                                            <div className="grid grid-cols-1 sm:grid-cols-10 gap-4">
                                                
                                                <label className="flex flex-col sm:col-span-2">
                                                    <span className="text-sm font-medium text-custom-primary mb-1">å¤©æ•¸ (Day)</span>
                                                    <input
                                                        type="number"
                                                        min="1"
                                                        value={newDay}
                                                        onChange={(e) => setNewDay(e.target.value)}
                                                        required
                                                        className="p-3 border border-gray-300 rounded-lg focus:ring-custom-accent focus:border-custom-accent transition duration-150 bg-custom-base"
                                                    />
                                                </label>

                                                <label className="flex flex-col sm:col-span-3">
                                                    <span className="text-sm font-medium text-custom-primary mb-1">é¡åˆ¥</span>
                                                    <select
                                                        value={newCategory}
                                                        onChange={(e) => setNewCategory(e.target.value)}
                                                        className="p-3 border border-gray-300 rounded-lg focus:ring-custom-accent focus:border-custom-accent transition duration-150 bg-custom-base"
                                                        required
                                                    >
                                                        {Object.keys(CATEGORY_MAP).map(key => (
                                                            <option key={key} value={key}>{CATEGORY_MAP[key].icon} {CATEGORY_MAP[key].label}</option>
                                                        ))}
                                                    </select>
                                                </label>

                                                <label className="flex flex-col sm:col-span-5">
                                                    <span className="text-sm font-medium text-custom-primary mb-1">åœ°é»åç¨± (å¿…å¡«)</span>
                                                    <input
                                                        type="text"
                                                        value={newLocation}
                                                        onChange={(e) => setNewLocation(e.target.value)}
                                                        placeholder="ä¾‹å¦‚ï¼šç‰›å³¶ã€æ¼¢æ‹å±±..."
                                                        required
                                                        className="p-3 border border-gray-300 rounded-lg focus:ring-custom-accent focus:border-custom-accent transition duration-150 bg-custom-base"
                                                    />
                                                </label>
                                            </div>
                                            <label className="flex flex-col">
                                                <span className="text-sm font-medium text-custom-primary mb-1">å‚™è¨»/æ´»å‹• (é¸å¡«)</span>
                                                <input
                                                    type="text"
                                                    value={newNotes}
                                                    onChange={(e) => setNewNotes(e.target.value)}
                                                    placeholder="ä¾‹å¦‚ï¼šç§Ÿæ©Ÿè»Šç’°å³¶ã€åˆé¤åƒé»‘è±¬è‚‰"
                                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-custom-accent focus:border-custom-accent transition duration-150 bg-custom-base"
                                                />
                                            </label>
                                            <button
                                                type="submit"
                                                className="w-full bg-custom-accent hover:bg-custom-primary text-white font-bold py-3 px-4 rounded-xl transition duration-200 shadow-lg hover:shadow-xl transform hover:scale-[1.01] active:scale-[0.99] focus:outline-none focus:ring-4 focus:ring-custom-accent/50"
                                            >
                                                <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 inline-block mr-1" viewBox="0 0 20 20" fill="currentColor">
                                                    <path fillRule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clipRule="evenodd" />
                                                </svg>
                                                åŠ å…¥è¡Œç¨‹
                                            </button>
                                        </form>
                                    </details>
                                </div>
                                
                                {/* 2. è¡Œç¨‹é¡¯ç¤ºå€åŸŸ */}
                                <div className="space-y-10 scrollable-planner">
                                    <h2 className="text-3xl font-black text-custom-dark-text border-b border-custom-accent/30 pb-3 flex items-center">
                                        <span role="img" aria-label="Map Pin" className="text-xl mr-2 opacity-70">ğŸ—ºï¸</span> å®Œæ•´è¡Œç¨‹ç´°ç¯€ ({days.length} å¤©)
                                    </h2>
                                    
                                    {days.length === 0 ? (
                                        <p className="text-custom-primary/70 italic p-6 bg-white rounded-xl text-center shadow-inner">ç›®å‰æ²’æœ‰ä»»ä½•è¡Œç¨‹ï¼Œè«‹åœ¨ä¸Šæ–¹æ–°å¢é …ç›®ã€‚</p>
                                    ) : (
                                        days.map(day => (
                                            <DayPlanner 
                                                key={day} 
                                                day={day} 
                                                dayItems={groupedItinerary[day]} 
                                                onUpdateOrder={handleUpdateOrder}
                                                onDelete={handleDeleteItem}
                                                onSearchGuide={handleSearchGuide}
                                            />
                                        ))
                                    )}
                                </div>
                            </div>
                        )}
                        
                    </div>
                    
                    {/* æ‡¸æµ®æ–°å¢æŒ‰éˆ• (å³ä¸‹è§’ +) */}
                    {currentTab === 'daily' && (
                        <button
                            className="fixed bottom-6 right-6 bg-custom-accent hover:bg-custom-primary text-white p-4 rounded-full shadow-2xl transition duration-300 transform hover:scale-110 active:scale-90 focus:outline-none focus:ring-4 focus:ring-custom-accent/70"
                            onClick={() => {
                                // æ»¾å‹•åˆ°æ–°å¢è¡¨å–®
                                window.scrollTo({ top: 0, behavior: 'smooth' });
                            }}
                            title="æ–°å¢è¡Œç¨‹"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
                                <path fillRule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clipRule="evenodd" />
                            </svg>
                        </button>
                    )}
                </div>
            );
        };
        
        // æ¸²æŸ“ App å…ƒä»¶åˆ°é é¢
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(React.createElement(App, null));
    </script>
</body>
</html>
